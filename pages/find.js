"use strict";function _interopRequireDefault(n){return n&&n.__esModule?n:{default:n}}function _asyncToGenerator(n){return function(){var t=n.apply(this,arguments);return new Promise(function(n,e){function r(o,i){try{var u=t[o](i),s=u.value}catch(n){return void e(n)}if(!u.done)return Promise.resolve(s).then(function(n){r("next",n)},function(n){r("throw",n)});n(s)}return r("next")})}}function _toConsumableArray(n){if(Array.isArray(n)){for(var t=0,e=Array(n.length);t<n.length;t++)e[t]=n[t];return e}return Array.from(n)}function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function _inherits(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function n(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),_wepy=require("./../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),_index=require("./../api/index.js"),Index=function(n){function t(){var n,e,r,o;_classCallCheck(this,t);for(var i=arguments.length,u=Array(i),s=0;s<i;s++)u[s]=arguments[s];return e=r=_possibleConstructorReturn(this,(n=t.__proto__||Object.getPrototypeOf(t)).call.apply(n,[this].concat(u))),r.config={navigationBarTitleText:"猜歌名"},r.components={},r.mixins=[],r.data={count:20,innerAudioContext:null,isPlay:!1,songList:[],curSong:null,curIndex:0,curInput:[],curKeyword:[],songInList:[],active:!1,index1:null},r.computed={now:function(){return+new Date}},r.methods={palyMusic:function(){var n=this.innerAudioContext;n.src=this.curSong.src,this.isPlay=!this.isPlay,this.isPlay?n.play():n.pause()},getWord:function(n,t){var e=this;console.log(n,t),this.index1=t;var r=this.curInput.findIndex(function(n){return""===n});-1!==r&&(this.curInput[r]=n,-1===(r=this.curInput.findIndex(function(n){return""===n}))&&(this.curInput.join("")===this.curSong.songname?0===this.songList.length?wx.showToast({title:"已经通关了!",icon:"success",duration:2e3}):setTimeout(function(){wx.showToast({title:"答对("+e.songInList.length+"/"+(e.songInList.length+e.songList.length)+")",icon:"success",duration:2e3}),e.index1=null,e.isPlay=!1,e.curSong=e.songList[Math.floor(Math.random()*e.songList.length)],e.songInList.push(e.curSong);var n=[].concat(_toConsumableArray(e.songList));e.curIndex=n.findIndex(function(n){return e.curSong===n}),n.splice(e.curIndex,1),e.songList=n;var t=[].concat(_toConsumableArray(e.curSong.keyword)).sort(function(){return Math.random()-.5});e.curKeyword=t,e.innerAudioContext.src=e.curSong.src,e.curInput=[];for(var r=0;r<e.curSong.songname.length;r++)e.curInput.push("");e.$apply()},300):wx.showToast({title:"回答错误",icon:"null",duration:2e3})))},clearInput:function(n){this.curInput[n]=""}},o=e,_possibleConstructorReturn(r,o)}return _inherits(t,n),_createClass(t,[{key:"onLoad",value:function(){function n(){return t.apply(this,arguments)}var t=_asyncToGenerator(regeneratorRuntime.mark(function n(){var t,e,r,o,i=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.innerAudioContext=wx.createInnerAudioContext(),n.next=3,(0,_index.getMusic)();case 3:for(t=n.sent,this.songList=t,this.curSong=t[Math.floor(Math.random()*t.length)],this.songInList.push(this.curSong),e=[].concat(_toConsumableArray(this.songList)),this.curIndex=e.findIndex(function(n){return i.curSong===n}),e.splice(this.curIndex,1),this.songList=e,r=[].concat(_toConsumableArray(this.curSong.keyword)).sort(function(){return Math.random()-.5}),this.curKeyword=r,o=0;o<this.curSong.songname.length;o++)this.curInput.push("");this.$apply();case 15:case"end":return n.stop()}},n,this)}));return n}()}]),t}(_wepy2.default.page);Page(require("./../npm/wepy/lib/wepy.js").default.$createPage(Index,"pages/find"));